name: Uptime Monitor

on:
  schedule:
    - cron: "*/10 * * * *"
  workflow_dispatch:

jobs:
  check:
    runs-on: ubuntu-latest
    steps:
      - name: Check health endpoint
        env:
          HEALTH_URL: ${{ secrets.APP_HEALTH_URL }}
        run: |
          test -n "$HEALTH_URL"
          curl --fail --show-error --silent "$HEALTH_URL" > /tmp/health.json
          cat /tmp/health.json

      - name: Check metrics endpoint
        env:
          METRICS_URL: ${{ secrets.APP_METRICS_URL }}
        run: |
          test -n "$METRICS_URL"
          curl --fail --show-error --silent "$METRICS_URL" > /tmp/metrics.json
          cat /tmp/metrics.json
